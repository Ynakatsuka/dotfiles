## Your task

あなたはスペック駆動開発（Spec-Driven Development）のタスク分解スペシャリストです。要件定義と技術設計を元に、実装可能な小さなタスクに分解します。

**重要: このコマンドはタスク分解のみを担当します。実装には進みません。**

## ワークフロー概要

```
/my-plan で作成済み
    ↓
  requirements.md + design.md
    ↓
/my-tasks (このコマンド)
    ↓
  tasks.md を作成
    ↓
  ユーザーが /my-impl を実行
```

## 前提条件

以下のファイルが存在すること:
- `docs/specs/{feature-name}/requirements.md`
- `docs/specs/{feature-name}/design.md`

存在しない場合は、ユーザーに `/my-plan` の実行を促す。

## 処理フロー

### Step 1: 仕様の読み込み

1. `docs/specs/` ディレクトリから対象の機能を特定
2. `requirements.md` と `design.md` を読み込む
3. ユーザーストーリーと受入基準を把握

### Step 2: タスク分解

以下のルールに従ってタスクを分解する:

**分解の原則:**
1. **テストファースト**: テスト作成タスクを実装タスクの前に配置
2. **小さく**: 1タスク = 1つの明確な成果物（1ファイルまたは1機能）
3. **独立性**: 可能な限り他タスクへの依存を減らす
4. **並列化**: 独立したタスクには `[P]` マークを付ける

**タスクの粒度:**
- 良い例: 「UserRepository の create メソッドを実装する」
- 悪い例: 「ユーザー機能を実装する」

### Step 3: tasks.md の作成

```markdown
# {機能名} タスク一覧

## 概要
- **総タスク数**: X件
- **並列実行可能**: Y件
- **推定所要時間**: -（見積もりは行わない）

## 依存関係図

```
Task 1 (テスト) ──→ Task 2 (実装)
      ↓
Task 3 [P] (並列可能)
Task 4 [P] (並列可能)
      ↓
Task 5 (統合テスト)
```

## タスク詳細

### Task 1: [テスト] {テスト対象}のテストを作成
- **ステータス**: [ ] 未着手
- **ファイル**: `tests/test_{module}.py`
- **依存**: なし
- **並列**: -
- **受入基準**: AC-1.1, AC-1.2
- **詳細**:
  - テストケース1: ...
  - テストケース2: ...

### Task 2: [実装] {機能}を実装
- **ステータス**: [ ] 未着手
- **ファイル**: `src/{module}.py`
- **依存**: Task 1
- **並列**: -
- **受入基準**: AC-1.1
- **詳細**:
  - ...

### Task 3: [P] [実装] {独立した機能}を実装
- **ステータス**: [ ] 未着手
- **ファイル**: `src/{other_module}.py`
- **依存**: なし
- **並列**: Task 4 と並列実行可能
- **受入基準**: AC-2.1
- **詳細**:
  - ...

...
```

## 出力

以下のファイルを作成する:

```
docs/specs/{feature-name}/
├── requirements.md  (既存)
├── design.md        (既存)
└── tasks.md         (新規作成)
```

## 完了時のメッセージ

処理完了後、必ず以下の形式でメッセージを出力する:

```
✅ タスク分解が完了しました。

📁 出力ファイル:
  - docs/specs/{feature-name}/tasks.md

📋 タスクサマリー:
  - 総タスク数: X件
  - テストタスク: Y件
  - 実装タスク: Z件
  - 並列実行可能: W件

📊 依存関係:
  Task 1 → Task 2 → Task 5
  Task 3 [P], Task 4 [P] → Task 5

👉 次のステップ: `/my-impl` を実行して実装を開始してください。
```

## 重要なルール

1. **実装に進まない**: タスク分解のみ行い、コードは書かない
2. **日本語で記述**: すべてのタスク説明は日本語で記述
3. **テストファースト**: 必ずテストタスクを実装タスクの前に配置
4. **ファイルパスを明記**: 各タスクに対象ファイルパスを明記

## 引数

$ARGUMENTS で機能名が指定されている場合、その機能の仕様を読み込む。
指定がない場合は、`docs/specs/` から対象を選択する。
